webpackJsonp([6],{P4P9:function(e,o,s){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=s("mvHQ"),r=s.n(a),t=s("cCj1"),l={data:function(){return{sexOpts:[{key:0,label:"男女",value:0},{key:1,label:"男",value:1},{key:2,label:"女",value:2}],booleanOpts:[{key:0,label:"否",value:0},{key:1,label:"是",value:1}],goodsForm:{type:this.param.type,tBId:this.param.tBId,name:this.param.data.name,number:this.param.data.number,descr:this.param.data.descr,salePrice:this.param.data.salePrice,wholesale:this.param.data.wholesale,purchasePrice:this.param.data.purchasePrice,stock:this.param.data.stock,sex:0,isHot:0,isRecommend:0,sources:JSON.parse(this.param.data.sources),coverSrc:""},rules:{type:[{required:!0,message:"请选择类型",trigger:"change"}],tBId:[{required:!0,message:"请选择品牌",trigger:"change"}],name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:3,max:30,message:"长度在 3 到 30 个字符",trigger:"blur"}],salePrice:[{required:!0,message:"请输入零售价",trigger:"blur"},{type:"number",message:"零售价必须是数字"}],wholesale:[{required:!0,message:"请输入批发价",trigger:"blur"},{type:"number",message:"批发价必须是数字"}],purchasePrice:[{required:!0,message:"请输入采购价",trigger:"blur"},{type:"number",message:"采购价必须是数字"}],stock:[{required:!0,message:"请输入库存",trigger:"blur"},{type:"number",message:"库存必须是数字"}]},goodsTypeData:this.getGoodsTypeData(),goodsBrandData:[{id:this.param.tBId,name:this.param.tBName}],brandSelectDisabled:!1,loading:!1,uploadInfo:{policy:this.getOssUploadInfo()[0],OSSAccessKeyId:this.getOssUploadInfo()[1],Signature:this.getOssUploadInfo()[2],key:"sj"+(new Date).getTime()},uploadUrl:"http://upload-z2.qiniup.com",dialogImageUrl:"",dialogVisible:!1,uploadFileLimit:9}},props:["param"],methods:{fetchGoodsBrandData:function(e){var o=this;this.$store.dispatch("ListGoodsBrand",e).then(function(e){o.goodsBrandData=e,o.brandSelectDisabled=!1}).catch(function(e){o.$message({showClose:!0,message:"获取商品品牌失败,原因=>"+e,type:"error"})})},handleGoodsTypeChange:function(e){this.type=e,this.fetchGoodsBrandData(e)},handleGoodsBrandChange:function(e){this.tBId=e},handleSexChange:function(e){this.sex=e},handleHotChange:function(e){this.isHot=e},handleRecommendChange:function(e){this.isRecommend=e},onSubmit:function(){var e=this;this.$refs.goodsForm.validate(function(o){if(!o)return e.$message({showClose:!0,message:"请检查输入内容是否有误",type:"error"}),!1;e.loading=!0,e.$store.dispatch("ModifyGoods",{id:e.param.data.id,type:e.goodsForm.type,tBId:e.goodsForm.tBId,name:e.goodsForm.name,number:e.goodsForm.number,descr:e.goodsForm.descr,salePrice:e.goodsForm.salePrice,wholesale:e.goodsForm.wholesale,purchasePrice:e.goodsForm.purchasePrice,stock:e.goodsForm.stock,sex:e.goodsForm.sex,isHot:e.isHot,isRecommend:e.isRecommend,sources:r()(e.goodsForm.sources)}).then(function(){e.loading=!1,e.$message({showClose:!0,message:"编辑成功",type:"success"})}).catch(function(o){e.loading=!1,e.$message({showClose:!0,message:o,type:"error"})})})},getGoodsTypeData:function(){var e=this.$store.state.goods.goodsTypeData;return e||Object(t.a)()},handleRemove:function(e,o){for(var s=-1,a=0;a<this.goodsForm.sources.length;a++){if(this.goodsForm.sources[a].id===e.response.hash){s=a;break}}-1!==s&&this.goodsForm.sources.splice(s,1)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleUpload:function(e,o,s){var a=this.uploadUrl+"/"+this.uploadInfo.key;this.goodsForm.sources.push({id:e.hash,url:a,name:o.name,size:o.size})},handleUploadError:function(e,o,s){this.$message({showClose:!0,message:"上传失败,"+e,type:"error"})},handleExceed:function(e,o){this.$message({showClose:!0,message:"Logo最多上传"+this.uploadFileLimit+"张图片,",type:"error"})},resetForm:function(e){this.goodsForm.sources=[],this.$refs.upload.clearFiles(),this.$refs[e].resetFields()},getOssUploadInfo:function(){return this.$store.getters.uploadToken.split(".")},handelRemoveCover:function(){this.goodsForm.coverSrc=""},handleUploadCover:function(){var e=this.uploadUrl+"/"+this.uploadInfo.key;this.goodsForm.coverSrc=e}}},i={render:function(){var e=this,o=e.$createElement,s=e._self._c||o;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"app-padding",staticStyle:{width:"600px"}},[s("el-form",{ref:"goodsForm",attrs:{model:e.goodsForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"类型",prop:"type"}},[s("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleGoodsTypeChange},model:{value:e.goodsForm.type,callback:function(o){e.$set(e.goodsForm,"type",o)},expression:"goodsForm.type"}},e._l(e.goodsTypeData,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"品牌",prop:"tBId"}},[s("el-select",{attrs:{disabled:e.brandSelectDisabled,placeholder:"请选择"},on:{change:e.handleGoodsBrandChange},model:{value:e.goodsForm.tBId,callback:function(o){e.$set(e.goodsForm,"tBId",o)},expression:"goodsForm.tBId"}},e._l(e.goodsBrandData,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"适用性别",prop:"sex"}},[s("el-select",{attrs:{placeholder:"男女"},on:{change:e.handleSexChange},model:{value:e.goodsForm.sex,callback:function(o){e.$set(e.goodsForm,"sex",o)},expression:"goodsForm.sex"}},e._l(e.sexOpts,function(e){return s("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"是否为热门",prop:"isHot"}},[s("el-select",{attrs:{placeholder:"否"},on:{change:e.handleHotChange},model:{value:e.goodsForm.isHot,callback:function(o){e.$set(e.goodsForm,"isHot",o)},expression:"goodsForm.isHot"}},e._l(e.booleanOpts,function(e){return s("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"是否为推荐",prop:"isRecommend"}},[s("el-select",{attrs:{placeholder:"否"},on:{change:e.handleRecommendChange},model:{value:e.goodsForm.isRecommend,callback:function(o){e.$set(e.goodsForm,"isRecommend",o)},expression:"goodsForm.isRecommend"}},e._l(e.booleanOpts,function(e){return s("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-input",{attrs:{clearable:""},model:{value:e.goodsForm.name,callback:function(o){e.$set(e.goodsForm,"name",o)},expression:"goodsForm.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"编号",prop:"number"}},[s("el-input",{attrs:{clearable:""},model:{value:e.goodsForm.number,callback:function(o){e.$set(e.goodsForm,"number",o)},expression:"goodsForm.number"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"零售价",prop:"salePrice"}},[s("el-input",{attrs:{clearable:""},model:{value:e.goodsForm.salePrice,callback:function(o){e.$set(e.goodsForm,"salePrice",e._n(o))},expression:"goodsForm.salePrice"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"批发价",prop:"wholesale"}},[s("el-input",{attrs:{clearable:""},model:{value:e.goodsForm.wholesale,callback:function(o){e.$set(e.goodsForm,"wholesale",e._n(o))},expression:"goodsForm.wholesale"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"采购价",prop:"purchasePrice"}},[s("el-input",{attrs:{clearable:""},model:{value:e.goodsForm.purchasePrice,callback:function(o){e.$set(e.goodsForm,"purchasePrice",e._n(o))},expression:"goodsForm.purchasePrice"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"库存",prop:"stock"}},[s("el-input",{attrs:{clearable:""},model:{value:e.goodsForm.stock,callback:function(o){e.$set(e.goodsForm,"stock",e._n(o))},expression:"goodsForm.stock"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"描述",prop:"descr"}},[s("el-input",{attrs:{type:"textarea",clearable:""},model:{value:e.goodsForm.descr,callback:function(o){e.$set(e.goodsForm,"descr",e._n(o))},expression:"goodsForm.descr"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"图片描述"}},[s("el-upload",{ref:"upload",attrs:{action:e.uploadUrl,"list-type":"picture-card",name:"file","file-list":e.goodsForm.sources,limit:e.uploadFileLimit,data:e.uploadInfo,"on-exceed":e.handleExceed,"on-success":e.handleUpload,"on-error":e.handleUploadError,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[s("i",{staticClass:"el-icon-plus"})]),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(o){e.dialogVisible=o}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),s("el-form-item",{attrs:{label:"封面图片"}},[s("el-upload",{ref:"uploadCover",attrs:{action:e.uploadUrl,"list-type":"picture-card",name:"file",limit:1,data:e.uploadInfo,"on-exceed":e.handleExceed,"on-success":e.handleUploadCover,"on-error":e.handleUploadError,"on-preview":e.handlePictureCardPreview,"on-remove":e.handelRemoveCover}},[s("i",{staticClass:"el-icon-plus"})]),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(o){e.dialogVisible=o}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),s("el-button",{on:{click:function(o){e.resetForm("goodsForm")}}},[e._v("复原")])],1)],1)],1)},staticRenderFns:[]};var n=s("VU/8")(l,i,!1,function(e){s("m0CB")},"data-v-62dda398",null);o.default=n.exports},SHay:function(e,o,s){(e.exports=s("FZ+f")(!1)).push([e.i,"\n.line[data-v-62dda398]{\r\n  text-align: center;\n}\r\n",""])},m0CB:function(e,o,s){var a=s("SHay");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);s("rjj0")("448d605d",a,!0)}});